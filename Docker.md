### 개요

최근 서비스 운영환경 관리에 도커(Docker)를 선택하는 것은 자연스러운 일이 되었습니다. 그만큼 도커를 사용하면 쉽고 간편하게 서비스 운영환경을 만들고 쓸 수 있습니다. 이제는 미룰 수 없게 된 도커 조금씩 정리해 봅니다.

이 글에서는 도커가 무엇인지 소개합니다. 그리고 무료 버전인 도커 커뮤니티 에디션을 우분투에 설치하는 방법을 다루겠습니다. 도커로 서비스 운영환경을 만들어가는 기초 내용은 다음 편에 소개하겠습니다.

참고로 도커를 학습하며 정리한 거라 다소 부족하거나 틀린점이 있을 수 있습니다. 그런 부분이 발견되면 댓글로 알려주시면 감사하겠습니다.

Immutable infrastructure – 변경 불가능한 인프라 구조

도커를 언급하기에 앞서 기본 배경 지식을 학습해 보겠습니다.

보통 서비스는 특정 호스트 OS(Windows, Linux 등) 위에 서비스 운영환경이 구축되어 운영됩니다. 여기서 서비스 운영환경이란, 개발 팀이 만든 소스 코드 및 컴파일된 코드, 그 코드를 구동시키기 위한 환경을 지칭합니다(가령, Nginx, Tomcat, War 등).

과거에는(지금도 많은 서비스들은) 호스트 OS에 운영환경 일부(Nginx, Tomcat, Apache 등)를 설치하고 개발 코드를 여기에 FTP 등으로 업로드(좀 크면 CI로 자동화 정도) 해서 서비스를 운영합니다. 이런 서비스 운영환경은 OS에 의존할 수밖에 없고 개발 코드(가령, war, php 등)는 자신이 실행될 환경에 적응해야 하는 구조가 됩니다. 이를 Mutable infrastructure(변경 가능한 인프라 구조)라고 합니다. 이런 구조에서는 서비스 운영환경이 호스트 OS에 의존적이고 개발 코드와도 일치하지 않는 버전이 될 수밖에 없습니다.

Immutable infrastructure(변경 불가능한 인프라 구조)이라는 개념은 서비스 운영환경이 호스트 OS의 환경 사정에 의해 변경되거나 개발 코드와 어긋나는 것을 막기 위해 도입된 개념입니다. 이 개념에서는 서비스 운영환경을 하나의 이미지(일종의 실행 파일입니다)로 생성하면 다시는 변경하지 않습니다. 즉, 호스트 OS 환경과 상관없는 하나의 서비스 운영환경 이미지로 만들어 버전 관리한다는 의미입니다. 그렇기에 Immutable infrastructure에서는 기존 서비스 운영환경 이미지는 버리고 새 이미지를 쓰는 거죠. 호스트 OS 환경에 상관없이요.

이미지가 배포가 되어 운영(실행) 되면 이를 컨테이너(container)라고 합니다. Windows로 따지면 이미지는 exe 파일 자체이고 컨테이너는 그 exe가 실행된 프로세스라고 보면 됩니다. 이렇게 하면 우리가 만드는 서비스가 더 이상 호스트 OS에 의존하지 않게 되고 언제 어디서나 동일한 운영환경에서 실행되게 됩니다.

그럼 이 컨테이너를 실행하는 환경(플랫폼)은 도대체 뭘까요? 이는 컨테이너를 실행시킬 수 있는 호스트 OS에 설치된 가상머신(Virtual Machine, VM)처럼 보입니다. 하지만 기존의 가상머신 개념과는 좀 다른데요. 기존의 가상머신은 호스트 OS 위에서 Hypervisor를 다루는 VMWare나 VirtualBox등의 가상머신을 설치하고 또 거기에 Guest OS를 설치해서 운영환경을 구축하는 형태입니다. 안정성과 보안성 측면에서는 좋지만 태생이 많이 무겁습니다. 반면, 컨테이너는 호스트 OS 위에 프로세스 단위의 격리환경내에 설치되고 실행되어 성능 손실이 거의 없습니다.



